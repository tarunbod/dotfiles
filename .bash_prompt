LAMBDA='λ'

# Most of this is a clone of Mathias Bynen's bash_prompt

# if [[ $COLORTERM = gnome-* && $TERM = xterm ]] && infocmp gnome-256color >/dev/null 2>&1; then
#   export TERM='gnome-256color';
# elif infocmp xterm-256color >/dev/null 2>&1; then
#   export TERM='xterm-256color';
# fi;

prompt_git() {
    local s='';
    local branchName='';

    # Check if the current directory is in a Git repository.
    if [ $(git rev-parse --is-inside-work-tree &>/dev/null; echo "${?}") == '0' ]; then

        if ! $(git diff-index --quiet HEAD --); then
               s+='+';
        fi;

        branchName="$(git symbolic-ref --quiet --short HEAD 2> /dev/null || \
            git rev-parse --short HEAD 2> /dev/null || \
            echo '(unknown)')";

        [ -n "${s}" ] && s=" [${s}]";

        echo -e "${1}${branchName}${2}${s}";
    else
        return;
    fi;
}

# bold="";
reset="\e[0m";
black="\e[1;30m";
blue="\e[1;94m";
cyan="\e[1;96m";
green="\e[1;32m";
orange="\e[1;33m";
purple="\e[1;35m";
red="\e[1;91m";
violet="\e[1;35m";
white="\e[1;37m";
yellow="\e[1;93m";

# Highlight the user name when logged in as root.
if [[ "${USER}" == "root" ]]; then
    userStyle="${red}";
else
    userStyle="${orange}";
fi;

hostStyle="${bold}${red}";

# Set the terminal title and prompt.
PS1="\n\[${red}\]\u"; # username
if [[ "${SSH_TTY}" ]]; then
    PS1+="\[${white}\] at ";
    PS1+="\[${hostStyle}\]\h"; # host
fi
PS1+="\[${white}\] in ";
PS1+="\[${cyan}\]\w"; # working directory full path
PS1+="\$(prompt_git \"\[${white}\] on \[${violet}\]\" \"\[${green}\]\")"; # Git repository details
PS1+="\n";
PS1+="\[${white}\]$LAMBDA \[${reset}\]"; # `$` (and reset color)
export PS1;

PS2="\[${yellow}\]→ \[${reset}\]";
export PS2;
